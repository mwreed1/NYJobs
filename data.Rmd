
```{r libs, include=F}
library(tidyverse)
library(redav)
library(janitor)
```


# Data 

## Sources

The primary data set we have chosen to use is the [NYC Jobs](https://catalog.data.gov/dataset/nyc-jobs) from data.gov. The data-set 
contains data from jobs listings around NYC. The data is collected from the City 
of New York's official jobs website [here](https://www1.nyc.gov/jobs/index.page). 

The data was first published January 8th 2020, and was most recently updated 
October 25th, 2022. The NYC OpenData project maintains the data. The data is 
available for download via csv. Thus, we intend to download the csv file and 
upload it directly into R. 

There are two reasons that we chose this dataset:
Firstly, the data was easily downloadable in a form that could be imported directly into R with little pre-processing. 
Secondly, it had several variables that we could explore the relationship between.There are many interesting things to discover, such as what categories have the most jobs, what kinds of jobs tend to have a higher salary, whether a higher leveljob has a higher salary, which location tends to pay more.


A brief explanation to some of the columns:

`Agency`: Name of the New York City agency (“agency” or “hiring agency”) where a 
job vacancy exists. 

`Posting Type`: Identifies whether a job posting is an Internal or External 
posting. Internal postings are available to City employees only and external 
postings are available to the general public. 

`Job Category:` Broad Classification of where all the jobs would fall in.

`Full-time/Part-Time`: Time frame of a job. 

`Salary Range From`: The beginning salary cap for that particular opening.

`Salary Range To`: The highest cap for that particular job opening. 

`Salary Frequency`: The payment factor for the job, hourly or annual.

`Work Location`: The location of the workplace.

`Job Description`: A brief idea of what the job will contain.

`Minimum Qual Requirements`: The minimum qualifications a candidate must possess 
for the job.

`Preferred Skills`: Optimal skills which the posting is looking for.

## Cleaning / transformation

```{r read-data}
jobs <- read_csv("data/NYC_Jobs.csv")
```

```{r data-clean}
jobs <- jobs %>%
  clean_names() %>%
  mutate(
    category_simple = case_when(
      str_detect(job_category, "Human Resources") ~ "Human Resources",
      str_detect(job_category, "Building Operations") ~ "Building Operations",
      str_detect(job_category, "Administrative Support") ~ "Administrative Support",
      str_detect(job_category, "Communications") ~ "Communications",
      str_detect(job_category, "Constituent Services") ~ "Constituent Services",
      str_detect(job_category, "Engineering") ~ "Engineering",
      str_detect(job_category, "Finance") ~ "Finance",
      str_detect(job_category, "Health") ~ "Health",
      str_detect(job_category, "Legal") ~ "Legal",
      str_detect(job_category, "Policy") ~ "Policy, Research & Analysis",
      str_detect(job_category, "Public Safety") ~ "Public Safety",
      str_detect(job_category, "Social Services") ~ "Social Services",
      str_detect(job_category, "Technology") ~ "Technology & Data",
      TRUE ~ "Other"
    ),
    agency_simple = str_to_title(agency),
    agency_simple = case_when(
      str_detect(agency_simple, "District Attorney") ~ "District Attorney",
      str_detect(agency_simple, "Community Board") ~ "Community Board",
      TRUE ~ agency_simple
    ),
    posting_date = as.Date(posting_date, "%m/%d/%Y")
  )
```


## Missing value analysis

```{r missing-data}
colSums(is.na(jobs)) %>%  
  sort(decreasing = TRUE)
plot_missing(
  jobs %>% 
    select(recruitment_contact, hours_shift, post_until, work_location_1, additional_information, preferred_skills, full_time_part_time_indicator, minimum_qual_requirements, job_category, career_level, to_apply)
  )
```



